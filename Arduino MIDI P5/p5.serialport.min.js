/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/p5.serialport@0.0.31/lib/p5.serialport.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
/*! p5.serialport.js v0.0.30 2022-07-17 */
!function(t,e){"function"==typeof define&&define.amd?define("p5.serialport",["p5"],(function(t){e(t)})):"object"==typeof exports?e(require("../p5")):e(t.p5)}(this,(function(t){t.SerialPort=function(t,e){let o=this;this.bufferSize=1,this.serialBuffer=[],this.serialConnected=!1,this.serialport=null,this.serialoptions=null,this.emitQueue=[],this.clientData={},this.serialportList=[],this.hostname="string"==typeof t?t:"localhost",this.serverport="number"==typeof e?e:8081;try{this.socket=new WebSocket("ws://"+this.hostname+":"+this.serverport),console.log("ws://"+this.hostname+":"+this.serverport)}catch(t){void 0!==o.errorCallback&&o.errorCallback("Couldn't connect to the server, is it running?")}this.socket.onopen=function(t){if(console.log("opened socket"),serialConnected=!0,void 0!==o.connectedCallback&&o.connectedCallback(),o.emitQueue.length>0){for(let t=0;t<o.emitQueue.length;t++)o.emit(o.emitQueue[t]);o.emitQueue=[]}},this.socket.onmessage=function(t){let e=JSON.parse(t.data);void 0!==e.method?"echo"==e.method||("openserial"===e.method?void 0!==o.openCallback&&o.openCallback():"data"===e.method?(o.serialBuffer.push(e.data),void 0!==o.dataCallback&&o.serialBuffer.length>=o.bufferSize&&o.dataCallback(),void 0!==o.rawDataCallback&&o.rawDataCallback(e.data)):"list"===e.method?(o.serialportList=e.data,void 0!==o.listCallback&&o.listCallback(e.data)):"close"===e.method?void 0!==o.closeCallback&&o.closeCallback():"write"===e.method||("error"===e.method?void 0!==o.errorCallback&&o.errorCallback(e.data):console.log("Unknown Method: "+e))):console.log("Method Undefined: "+e)},this.socket.onclose=function(t){void 0!==o.closeCallback&&o.closeCallback()},this.socket.onerror=function(t){void 0!==o.errorCallback&&o.errorCallback()}},t.SerialPort.prototype.emit=function(t){this.socket.readyState==WebSocket.OPEN?this.socket.send(JSON.stringify(t)):this.emitQueue.push(t)},t.SerialPort.prototype.isConnected=function(){return!!self.serialConnected},t.SerialPort.prototype.list=function(t){return"function"==typeof t&&(this.listCallback=t),this.emit({method:"list",data:{}}),this.serialportList},t.SerialPort.prototype.open=function(t,e,o){"function"==typeof o&&(this.openCallback=o),this.serialport=t,this.serialoptions="object"==typeof e?e:{},this.emit({method:"openserial",data:{serialport:this.serialport,serialoptions:this.serialoptions}})},t.SerialPort.prototype.write=function(t){let e=null;e="number"==typeof t?[t]:("string"==typeof t||Array.isArray(t),t),this.emit({method:"write",data:e})},t.SerialPort.prototype.read=function(){return this.serialBuffer.length>0?this.serialBuffer.shift():-1},t.SerialPort.prototype.readChar=function(){return this.serialBuffer.length>0?String.fromCharCode(this.serialBuffer.shift()):-1},t.SerialPort.prototype.readBytes=function(){if(this.serialBuffer.length>0){let t=this.serialBuffer.slice();return this.serialBuffer.length=0,t}return-1},t.SerialPort.prototype.readBytesUntil=function(t){console.log("Looking for: "+t.charCodeAt(0));let e=this.serialBuffer.indexOf(t.charCodeAt(0));if(-1!==e){let t=this.serialBuffer.slice(0,e+1);return this.serialBuffer=this.serialBuffer.slice(e,this.serialBuffer.length+e),t}return-1},t.SerialPort.prototype.readString=function(){let t=[];for(let e=0;e<this.serialBuffer.length;e++)t.push(String.fromCharCode(this.serialBuffer[e]));return this.serialBuffer.length=0,t.join("")},t.SerialPort.prototype.readStringUntil=function(t){let e=[];for(let t=0;t<this.serialBuffer.length;t++)e.push(String.fromCharCode(this.serialBuffer[t]));e=e.join("");let o="",r=e.indexOf(t);return r>-1&&(o=e.substr(0,r),this.serialBuffer=this.serialBuffer.slice(r+t.length)),o},t.SerialPort.prototype.readLine=function(){return this.readStringUntil("\r\n")},t.SerialPort.prototype.available=function(){return this.serialBuffer.length},t.SerialPort.prototype.last=function(){let t=this.serialBuffer.pop();return this.serialBuffer.length=0,t},t.SerialPort.prototype.lastChar=function(){return String.fromCharCode(this.last())},t.SerialPort.prototype.clear=function(){this.serialBuffer.length=0},t.SerialPort.prototype.stop=function(){},t.SerialPort.prototype.close=function(t){"function"==typeof t&&(this.closeCallback=t),this.emit({method:"close",data:{}})},t.SerialPort.prototype.onData=function(t){this.on("data",t)},t.SerialPort.prototype.onOpen=function(t){this.on("open",t)},t.SerialPort.prototype.onClose=function(t){this.on("close",t)},t.SerialPort.prototype.onError=function(t){this.on("error",t)},t.SerialPort.prototype.onList=function(t){this.on("list",t)},t.SerialPort.prototype.onConnected=function(t){this.on("connected",t)},t.SerialPort.prototype.onRawData=function(t){this.on("rawdata",t)},t.SerialPort.prototype.on=function(t,e){"open"==t?this.openCallback=e:"data"==t?this.dataCallback=e:"close"==t?this.closeCallback=e:"error"==t?this.errorCallback=e:"list"==t?this.listCallback=e:"connected"==t?this.connectedCallback=e:"rawdata"==t&&(this.rawDataCallback=e)}}));
//# sourceMappingURL=/sm/839a0eee3839f51a25ad383e398cb43e8119e53181571761ec978cff3e55f71a.map